load carbonate_parameters;
%%


%omega
ksr_yu_n_fit=[0.168194757
0.168204381
0.155767208
0.149356019
0.163574629
0.16541509
0.148805882
0.165522284
];
err_n=ksr_yu_n-ksr_yu_n_fit;
omega_n=omega_yu_n;
figure
set(gcf,'Position',[0, 0, 1100, 1000])
ax(3)=subplot(2,3,1);
% set(gcf,'Position',[100, 0, 700,600])
scatter (omega_n,err_n,'o','MarkerEdgeColor',[235,77,75]./255,'linewidth',1)
hold on
ax = gca;
ax.LineWidth = 1.5;
box on


ksr_yu_a_fit=[0.156070288
0.151627725
0.152680442
0.151339854
0.147524159
0.151349151
0.149068647
0.159017986
0.147639237
0.150087522
0.149513099
0.152616067
0.149720583
0.148954909
0.151534939
0.152643661
0.150827411
0.143199524
0.151041971
0.15270802
0.135500806
0.141005927
0.14294104
0.14646424
0.157826536
0.148241628
0.140286768
0.138641456
0.144444802
0.160111284
0.144964969
0.139991898
0.159209604
0.161348635
0.145424452
0.149560286
0.153267405
0.158528833
0.162641011
0.159209604
0.151284057
0.142312544
0.133050917
0.137464231
0.156623022
0.150397122
0.147447381
0.14460206
0.143368251
0.141429499
0.135248183
0.152413522
0.148546471
0.132311218
0.145930855
0.143892853
0.1370072
];
err_a=ksr_yu_a-ksr_yu_a_fit;
omega_a=omega_yu_a;
scatter (omega_a,err_a,'d','MarkerEdgeColor',[126,214,223]./255,'linewidth',1)
hold on

ksr_yu_i_fit=[0.13911501
0.143371302
0.134820091
0.143832468
0.139176179
0.15151381
0.155873244
0.138706425
0.140039423
0.142314344
0.141347665
0.139206752
0.141197456
0.145426839
0.148565838
0.149999472
0.142591881
];
err_i=ksr_yu_i-ksr_yu_i_fit;
omega_i=omega_yu_i;
scatter (omega_i,err_i,'v','MarkerEdgeColor',[249,202,36]./255,'linewidth',1)
hold on




ksr_yu_p_fit=[0.135438814
0.151658124
0.155799657
0.142578344
0.159022149
0.158954587
0.136470019
0.135449165
0.158251096
0.161607775
0.161591293
0.158242592
0.155790956
0.14990876
0.149853644
0.145679185
0.135469865
0.154530615
0.142783701
];
err_p=ksr_yu_p-ksr_yu_p_fit;
omega_p=omega_yu_p;
scatter (omega_p,err_p,'p','MarkerEdgeColor',[240,147,43]./255,'linewidth',1)
hold on
xx = 0:1:4;
yy = 0+zeros(5,1);
plot(xx,yy,'--','color','k','linewidth',1)
xlabel('\Omega_{sw}','fontsize',18,'interpreter','tex')
ylabel('D_{sr} residuals','fontsize',18,'interpreter','tex')
ylim([-12e-3 12e-3])
xlim([0 3])
% set(findobj(gcf,'type','axes'),'FontName','Times New Roman','FontSize',16,'Fontweight','bold','LineWidth', 2)
title(['(a)'],'Fontsize',14);


%%
% DIC
% ksr_yu_n_fit=[0.171553951922757,0.171565779845335,0.156284249151876,0.148467971025179,0.165872053242206,0.168136041255837,0.147801092765793,0.168267895484964]';
% err_n=ksr_yu_n-ksr_yu_n_fit;
DIC_n=DIC_yu_n;
% figure
ax(3)=subplot(2,3,2);
% set(gcf,'Position',[100, 0, 700,600])
scatter (DIC_n,err_n,'o','MarkerEdgeColor',[235,77,75]./255,'linewidth',1)
hold on
ax = gca;
ax.LineWidth = 1.5;
box on


% ksr_yu_a_fit=[0.158566815451067;0.152891850489372;0.154232674786968;0.152525675568524;0.147693930685124;0.152537498045030;0.149644335469941;0.162351717155623;0.147839009204486;0.150935248735561;0.150206997886089;0.154150605628680;0.150470064151502;0.149500440344898;0.152773802284736;0.154185782342616;0.151874377407504;0.142274876616936;0.152146991853142;0.154267836736892;0.132812067030350;0.139552989628141;0.141953150268574;0.146359728308168;0.160820438929235;0.148599133121590;0.138664895406325;0.136641349297618;0.143828396856084;0.163758332472260;0.144479026216482;0.138301386376861;0.162598147572315;0.165351431033950;0.145054566350530;0.150266768391245;0.154981420470035;0.161722830279760;0.167016364329586;0.162598147572315;0.152454726197261;0.141171973598093;0.129856926861299;0.135200777111494;0.159275522307191;0.151328060739326;0.147597159860062;0.144024992478053;0.142485024102533;0.140077064407828;0.132506024831440;0.153892449961897;0.148984231409927;0.128970373826795;0.145689744577120;0.143139103350196;0.134643131575462];
% err_a=ksr_yu_a-ksr_yu_a_fit;
DIC_a=DIC_yu_a;
scatter (DIC_a,err_a,'d','MarkerEdgeColor',[126,214,223]./255,'linewidth',1)
hold on

% ksr_yu_i_fit=[0.136547687074895;0.141818488864415 ;0.131322121521084;0.142394768757619 ;0.136622802773260 ;0.152127928570668 ;0.157748644976790 ;0.136046435827292 ;0.137684971559994 ;0.140501449492369;0.139301571056747 ;0.136660353482504 ;0.139115532131054 ;0.144394595309908 ;0.148364139116674 ;0.150190427163930 ;0.140846768053451];
% err_i=ksr_yu_i-ksr_yu_i_fit;
DIC_i=DIC_yu_i;
scatter (DIC_i,err_i,'v','MarkerEdgeColor',[249,202,36]./255,'linewidth',1)
hold on




% ksr_yu_p_fit=[0.132195516303675 ,0.152368317939179 ,0.157676269412351,0.140934971910825 ,0.161835286401657 ,0.161747880005539 ,0.133442468634162,0.132208006318028,0.160838247780018 ,0.165185724199837 ,0.165164337393921 ,0.160827257352052 ,0.157665070319512,0.150141721064864,0.150071735449147,0.144803300549762,0.132232985129539 ,0.156044848982512,0.141189874563966]';
% err_p=ksr_yu_p-ksr_yu_p_fit;
DIC_p=DIC_yu_p;
scatter (DIC_p,err_p,'p','MarkerEdgeColor',[240,147,43]./255,'linewidth',1)
hold on
xx = 2000:100:2500;
yy = 0+zeros(6,1);
plot(xx,yy,'--','color','k','linewidth',1)
xlabel('DIC_{sw} (\mumol/kg)','fontsize',18,'interpreter','tex')
ylabel('D_{sr} residuals','fontsize',18,'interpreter','tex')
ylim([-12e-3 12e-3])
xlim([2000 2400])
title(['(b)'],'Fontsize',14);


%%
% co3
% ksr_yu_n_fit=[0.171553951922757,0.171565779845335,0.156284249151876,0.148467971025179,0.165872053242206,0.168136041255837,0.147801092765793,0.168267895484964]';
% err_n=ksr_yu_n-ksr_yu_n_fit;
co3_n=co3_yu_n;
% figure
ax(3)=subplot(2,3,3);
% set(gcf,'Position',[100, 0, 700,600])
scatter (co3_n,err_n,'o','MarkerEdgeColor',[235,77,75]./255,'linewidth',1)
hold on
ax = gca;
ax.LineWidth = 1.5;
box on


% ksr_yu_a_fit=[0.158566815451067;0.152891850489372;0.154232674786968;0.152525675568524;0.147693930685124;0.152537498045030;0.149644335469941;0.162351717155623;0.147839009204486;0.150935248735561;0.150206997886089;0.154150605628680;0.150470064151502;0.149500440344898;0.152773802284736;0.154185782342616;0.151874377407504;0.142274876616936;0.152146991853142;0.154267836736892;0.132812067030350;0.139552989628141;0.141953150268574;0.146359728308168;0.160820438929235;0.148599133121590;0.138664895406325;0.136641349297618;0.143828396856084;0.163758332472260;0.144479026216482;0.138301386376861;0.162598147572315;0.165351431033950;0.145054566350530;0.150266768391245;0.154981420470035;0.161722830279760;0.167016364329586;0.162598147572315;0.152454726197261;0.141171973598093;0.129856926861299;0.135200777111494;0.159275522307191;0.151328060739326;0.147597159860062;0.144024992478053;0.142485024102533;0.140077064407828;0.132506024831440;0.153892449961897;0.148984231409927;0.128970373826795;0.145689744577120;0.143139103350196;0.134643131575462];
% err_a=ksr_yu_a-ksr_yu_a_fit;
co3_a=co3_yu_a;
scatter (co3_a,err_a,'d','MarkerEdgeColor',[126,214,223]./255,'linewidth',1)
hold on

% ksr_yu_i_fit=[0.136547687074895;0.141818488864415 ;0.131322121521084;0.142394768757619 ;0.136622802773260 ;0.152127928570668 ;0.157748644976790 ;0.136046435827292 ;0.137684971559994 ;0.140501449492369;0.139301571056747 ;0.136660353482504 ;0.139115532131054 ;0.144394595309908 ;0.148364139116674 ;0.150190427163930 ;0.140846768053451];
% err_i=ksr_yu_i-ksr_yu_i_fit;
co3_i=co3_yu_i;
scatter (co3_i,err_i,'v','MarkerEdgeColor',[249,202,36]./255,'linewidth',1)
hold on




% ksr_yu_p_fit=[0.132195516303675 ,0.152368317939179 ,0.157676269412351,0.140934971910825 ,0.161835286401657 ,0.161747880005539 ,0.133442468634162,0.132208006318028,0.160838247780018 ,0.165185724199837 ,0.165164337393921 ,0.160827257352052 ,0.157665070319512,0.150141721064864,0.150071735449147,0.144803300549762,0.132232985129539 ,0.156044848982512,0.141189874563966]';
% err_p=ksr_yu_p-ksr_yu_p_fit;
co3_p=co3_yu_p;
scatter (co3_p,err_p,'p','MarkerEdgeColor',[240,147,43]./255,'linewidth',1)
hold on
xx = 60:10:140;
yy = 0+zeros(9,1);
plot(xx,yy,'--','color','k','linewidth',1)
xlabel('CO_{3}^{2-}_{ sw} (\mumol/kg)','fontsize',18,'interpreter','tex')
ylabel('D_{sr} residuals','fontsize',18,'interpreter','tex')
ylim([-12e-3 12e-3])
xlim([60 140])
title(['(c)'],'Fontsize',14);


%%
% ksr_yu_n_fit=[0.171553951922757,0.171565779845335,0.156284249151876,0.148467971025179,0.165872053242206,0.168136041255837,0.147801092765793,0.168267895484964]';
% err_n=ksr_yu_n-ksr_yu_n_fit;
ph_n=pH_yu_n;
% figure
ax(3)=subplot(2,3,4);
% set(gcf,'Position',[100, 0, 700,600])
scatter (ph_n,err_n,'o','MarkerEdgeColor',[235,77,75]./255,'linewidth',1)
hold on
ax = gca;
ax.LineWidth = 1.5;
box on


% ksr_yu_a_fit=[0.158566815451067;0.152891850489372;0.154232674786968;0.152525675568524;0.147693930685124;0.152537498045030;0.149644335469941;0.162351717155623;0.147839009204486;0.150935248735561;0.150206997886089;0.154150605628680;0.150470064151502;0.149500440344898;0.152773802284736;0.154185782342616;0.151874377407504;0.142274876616936;0.152146991853142;0.154267836736892;0.132812067030350;0.139552989628141;0.141953150268574;0.146359728308168;0.160820438929235;0.148599133121590;0.138664895406325;0.136641349297618;0.143828396856084;0.163758332472260;0.144479026216482;0.138301386376861;0.162598147572315;0.165351431033950;0.145054566350530;0.150266768391245;0.154981420470035;0.161722830279760;0.167016364329586;0.162598147572315;0.152454726197261;0.141171973598093;0.129856926861299;0.135200777111494;0.159275522307191;0.151328060739326;0.147597159860062;0.144024992478053;0.142485024102533;0.140077064407828;0.132506024831440;0.153892449961897;0.148984231409927;0.128970373826795;0.145689744577120;0.143139103350196;0.134643131575462];
% err_a=ksr_yu_a-ksr_yu_a_fit;
ph_a=pH_yu_a;
scatter (ph_a,err_a,'d','MarkerEdgeColor',[126,214,223]./255,'linewidth',1)
hold on

% ksr_yu_i_fit=[0.136547687074895;0.141818488864415 ;0.131322121521084;0.142394768757619 ;0.136622802773260 ;0.152127928570668 ;0.157748644976790 ;0.136046435827292 ;0.137684971559994 ;0.140501449492369;0.139301571056747 ;0.136660353482504 ;0.139115532131054 ;0.144394595309908 ;0.148364139116674 ;0.150190427163930 ;0.140846768053451];
% err_i=ksr_yu_i-ksr_yu_i_fit;
ph_i=pH_yu_i;
scatter (ph_i,err_i,'v','MarkerEdgeColor',[249,202,36]./255,'linewidth',1)
hold on




% ksr_yu_p_fit=[0.132195516303675 ,0.152368317939179 ,0.157676269412351,0.140934971910825 ,0.161835286401657 ,0.161747880005539 ,0.133442468634162,0.132208006318028,0.160838247780018 ,0.165185724199837 ,0.165164337393921 ,0.160827257352052 ,0.157665070319512,0.150141721064864,0.150071735449147,0.144803300549762,0.132232985129539 ,0.156044848982512,0.141189874563966]';
% err_p=ksr_yu_p-ksr_yu_p_fit;
ph_p=pH_yu_p;
scatter (ph_p,err_p,'p','MarkerEdgeColor',[240,147,43]./255,'linewidth',1)
hold on
xx = 7.7:0.1:8.2;
yy = 0+zeros(6,1);
plot(xx,yy,'--','color','k','linewidth',1)
xlabel('pH_{sw}','fontsize',18,'interpreter','tex')
ylabel('D_{sr} residuals','fontsize',18,'interpreter','tex')
ylim([-12e-3 12e-3])
xlim([7.7 8.2])
set(gca,'Xtick',[7.7  7.8 7.9 8.0 8.1 8.2])

title(['(d)'],'Fontsize',14);


%%
T_n=[-0.8
-0.8
-1.1
-0.9
-0.8
-1.1
-0.9
-0.8];
T_i=[1.1
1.2
1.0
1.3
1.1
1.9
2.2
1.0
1.1
1.4
1.2
1.1
1.5
1.6
1.7
1.5
1.2
];
T_p=[1.3
1.7
1.9
1.5
2.3
2.3
1.3
1.3
2.2
2.8
2.8
2.2
2.0
1.7
1.7
1.5
1.3
1.9
1.5
];
T_a=[3.2
2.7
2.7
2.9
2.8
3.0
3.0
3.4
2.8
2.9
2.9
3.0
2.9
2.8
3.0
3.0
2.9
2.5
2.6
2.8
2.6
2.6
2.6
2.8
3.3
2.8
2.6
2.6
2.5
3.6
2.5
2.5
3.4
3.4
2.5
2.7
2.4
2.6
4.1
4.0
4.2
4.3
4.4
2.0
3.1
2.7
2.5
2.4
2.3
2.2
1.4
2.8
2.6
2.1
2.2
2.5
2.5
];

% figure
ax(3)=subplot(2,3,5);

% set(gcf,'Position',[100, 0, 700,600])
scatter (T_n,err_n,'o','MarkerEdgeColor',[235,77,75]./255,'linewidth',1)
hold on
ax = gca;
ax.LineWidth = 1.5;
box on
scatter (T_a,err_a,'d','MarkerEdgeColor',[126,214,223]./255,'linewidth',1)
hold on


scatter (T_i,err_i,'v','MarkerEdgeColor',[249,202,36]./255,'linewidth',1)
hold on
scatter (T_p,err_p,'p','MarkerEdgeColor',[240,147,43]./255,'linewidth',1)
hold on
xx = -2:1:6;
yy = 0+zeros(9,1);
plot(xx,yy,'--','color','k','linewidth',1)
xlabel('T_{sw} (\circC)','fontsize',18,'interpreter','tex')
ylabel('D_{sr} residuals','fontsize',18,'interpreter','tex')
ylim([-12e-3 12e-3])
xlim([-2 6])
title(['(e)'],'Fontsize',14);

%%
S_n=[34.9
34.9
34.9
34.9
34.9
34.9
34.9
34.9
];
S_i=[34.7
34.7
34.7
34.7
34.7
34.7
34.7
34.7
34.7
34.7
34.7
34.7
34.7
34.7
34.7
34.7
34.7
];
S_p=[34.7
34.7
34.7
34.7
34.6
34.6
34.7
34.7
34.6
34.6
34.6
34.6
34.6
34.7
34.7
34.7
34.7
34.7
34.7
];
S_a=[35.0
35.0
35.0
35.0
35.0
34.9
34.9
34.9
34.9
34.9
34.9
34.9
34.9
34.9
34.9
34.9
34.9
34.9
35.0
34.9
34.9
34.9
34.9
34.9
34.9
34.9
34.9
34.9
34.9
34.9
34.9
34.9
34.9
34.9
34.9
34.9
34.9
34.8
35.0
35.0
35.0
35.0
35.0
34.9
34.9
34.9
34.9
34.9
34.9
34.9
34.8
34.9
34.9
34.9
34.9
34.9
34.9
];

% figure
ax(3)=subplot(2,3,6);

% set(gcf,'Position',[100, 0, 700,600])
scatter (S_n,err_n,'o','MarkerEdgeColor',[235,77,75]./255,'linewidth',1)
hold on
ax = gca;
ax.LineWidth = 1.5;
box on
scatter (S_a,err_a,'d','MarkerEdgeColor',[126,214,223]./255,'linewidth',1)
hold on


scatter (S_i,err_i,'v','MarkerEdgeColor',[249,202,36]./255,'linewidth',1)
hold on
scatter (S_p,err_p,'p','MarkerEdgeColor',[240,147,43]./255,'linewidth',1)
hold on
xx =34.5:0.1:35;
yy = 0+zeros(6,1);
plot(xx,yy,'--','color','k','linewidth',1)
xlabel('S_{sw}','fontsize',18,'interpreter','tex')
ylabel('D_{sr} residuals','fontsize',18,'interpreter','tex')
ylim([-12e-3 12e-3])
xlim([34.5 35])
set(gca,'Xtick',[34.5 34.6 34.7 34.8 34.9 35.0])

title(['(f)'],'Fontsize',14);


%%
load carbonate_parameters_Cm;
ksr_yu_a_cm_fit=[0.139827706438215;0.139038161812046;0.141678255454899;0.142793125422430;0.140960246186245;0.132983580342567;0.130638807209868;0.139662805717823;0.132708013046282;0.136440506300969;0.147798298836624;0.138298567123051;0.129867570094902;0.128100076811979;0.134307747816826;0.155275625094241;0.149063043959488;0.150946246758519;0.154981088985696;0.135344890950996;0.143713062580381;0.148444830174971;0.143177750364069;0.141424216389743;0.146670924619370;0.140521280414455;0.137470775741604;0.133163335370327;0.142562795422738;0.138615117155048;0.133721568227274;0.126342051959813];
err_A=DSr_cm_A-ksr_yu_a_cm_fit;
omega_A=omega_cm_A;
% figure
set(gcf,'Position',[0, 0, 1100, 1000])
ax(3)=subplot(2,3,1);
scatter (omega_A,err_A,'s','MarkerEdgeColor',[106,176,76]./255,'linewidth',1)
hold on
ax = gca;
ax.LineWidth = 1.5;
box on
%
DIC_A=DIC_A;
ax(3)=subplot(2,3,2);
scatter (DIC_A,err_A,'s','MarkerEdgeColor',[106,176,76]./255,'linewidth',1)
%

% CO3_A=CO3_A;
ax(3)=subplot(2,3,3);
scatter (CO3_A,err_A,'s','MarkerEdgeColor',[106,176,76]./255,'linewidth',1)
%
% pH_A=pH_A;
ax(3)=subplot(2,3,4);
scatter (pH_A,err_A,'s','MarkerEdgeColor',[106,176,76]./255,'linewidth',1)
%

CO3_A=CO3_A;
ax(3)=subplot(2,3,3);
scatter (CO3_A,err_A,'s','MarkerEdgeColor',[106,176,76]./255,'linewidth',1)

%

T_A=[2.89
2.77
2.96
3.00
2.91
2.51
2.56
2.87
2.65
2.80
3.31
2.79
2.58
2.55
2.51
6.00
3.42
3.44
5.50
2.48
3.09
2.63
4.13
4.15
3.14
2.70
2.54
2.34
2.84
2.62
2.52
2.50
];
ax(3)=subplot(2,3,5);
scatter (T_A,err_A,'s','MarkerEdgeColor',[106,176,76]./255,'linewidth',1)
%

S_A=[34.94
34.94
34.95
34.95
34.95
34.91
34.91
34.94
34.93
34.93
34.91
34.94
34.92
34.91
34.91
35.10
34.93
34.89
35.06
34.91
34.98
34.77
34.98
34.98
34.95
34.92
34.91
34.90
34.94
34.92
34.91
34.90
];
ax(3)=subplot(2,3,6);
scatter (S_A,err_A,'s','MarkerEdgeColor',[106,176,76]./255,'linewidth',1)
set(findobj(gcf,'type','axes'),'FontName','Times New Roman','FontSize',12,'Fontweight','bold')

